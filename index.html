<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>DistyVault</title>
        <link rel="icon" type="image/png" href="logos/logo_no_bg.png">
        <link rel="dns-prefetch" href="https://fonts.googleapis.com">
        <link rel="dns-prefetch" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
        <!-- TailwindCSS Play CDN for zero-build styling -->
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            // Tailwind configuration and CSS variables for theming
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            brand: {
                                DEFAULT: '#6D28D9',
                                foreground: '#FFFFFF',
                            },
                            muted: '#6b7280',
                        },
                        boxShadow: {
                            soft: '0 2px 8px rgba(0,0,0,0.08)',
                        }
                    }
                }
            }
        </script>
        <style>
            :root { color-scheme: light dark; }
            html, body { height: 100%; }
            body { font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }
            /* Smooth scrollbar for webkit */
            * { scrollbar-width: thin; }
            ::-webkit-scrollbar { width: 10px; height: 10px; }
            ::-webkit-scrollbar-thumb { background: rgba(100,116,139,.5); border-radius: 8px; }
            ::-webkit-scrollbar-track { background: transparent; }
        </style>
</head>

<body>
        <div id="root"></div>

    <!-- Polyfills -->
    <script>
        // requestIdleCallback polyfill (define on window and global scope)
        (function() {
            if (!('requestIdleCallback' in window)) {
                window.requestIdleCallback = function(callback, options) {
                    const start = Date.now();
                    return setTimeout(function() {
                        callback({
                            didTimeout: false,
                            timeRemaining: function() { return Math.max(0, 50 - (Date.now() - start)); }
                        });
                    }, 1);
                };
            }
            if (typeof requestIdleCallback === 'undefined') {
                try { var requestIdleCallback = window.requestIdleCallback.bind(window); } catch (e) {}
            }
            if (!('cancelIdleCallback' in window)) {
                window.cancelIdleCallback = function(id) { clearTimeout(id); };
            }
            if (typeof cancelIdleCallback === 'undefined') {
                try { var cancelIdleCallback = window.cancelIdleCallback.bind(window); } catch (e) {}
            }
        })();
        // Disable legacy UI initialization so we can mount React
        window.DV_DISABLE_LEGACY_UI = true;
    </script>
    
    <!-- Utility Modules (keep only those needed by core logic) -->
    <script src="src/utils/dateUtils.js"></script>
    <script src="src/utils/validationUtils.js"></script>
    <script src="src/utils/errorUtils.js"></script>

    <!-- Core Services required for ApiClient (EventBus, DB, AI) -->
    <script src="src/core/eventBus.js"></script>
    <script src="src/core/database.js"></script>
    <script src="src/ai/aiProvider.js"></script>
    <script src="src/ai/providers/openAI.js"></script>
    <script src="src/ai/providers/anthropic.js"></script>
    <script src="src/ai/providers/google.js"></script>
    <script src="src/ai/providers/ollama.js"></script>
    <script src="src/ai/providers/grok.js"></script>
    <script src="src/ai/providers/deepseek.js"></script>
    <script src="src/ai/aiProviderFactory.js"></script>
    <script src="src/ai/aiSettingsManager.js"></script>
    <script src="src/ai/aiService.js"></script>
    <script src="src/core/apiClient.js"></script>

    <!-- React and Babel (no build tools) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Mount React UI -->
    <script type="text/babel" data-type="module" data-presets="env,react" src="src/react/App.jsx"></script>
</body>

</html>
